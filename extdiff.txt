--- ext.c	Tue Apr 30 06:31:55 2002
+++ extn.c	Sun Mar 31 19:17:35 2002
@@ -1,6 +1,8 @@
 /*redirecting extension file
 was automatically generated by script makeext.pl */
 
+//modify as usual AND "make extdiff" for special (one time) adaptions
+
 #include "base.h"
 
 int (*orig_sys_open)(const char *pathname, int oflags, mode_t mode);
@@ -248,7 +250,10 @@
 		BEGIN_KMEM
 			result = orig_sys_readlink(local0, local1, bufsiz);
 		END_KMEM
-		if(result>=0){copy_to_user(buf, local1, result+1);}
+		if(result>=0 && result<bufsiz){
+			//if(unredirect(local1)) result=strlen(local1)+1;
+			if(copy_to_user(buf, local1, result+1)) return -EFAULT;
+		}
 		if(result!=-ENOENT) return result;
 	}
 	return orig_sys_readlink(path, buf, bufsiz);
